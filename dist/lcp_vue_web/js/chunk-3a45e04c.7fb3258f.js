(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3a45e04c"],{"4e92":function(e,t,a){},6301:function(e,t,a){"use strict";a.r(t),a("b0c0");var r=a("c7eb"),i=a("1da1"),s=(a("a9e3"),a("99af"),a("b32d")),o=a("bd97"),n=(a("a15b"),a("d81d"),a("ac1f"),a("5319"),a("14d9"),a("b64b"),{props:{url:String,domainId:Number,domainCode:String,inParamList:Array,outParamList:Array,errorCodeList:Array},data:function(){return{requestAddressTableData:[],publicParamsTableData:[],inParamsTableData:[],outParamsTableData:[],errorCodeTableData:[]}},methods:{formatTableColumnDescriptionInnerHtml:function(e){return e=(e=e||"").split("\n").map((function(e){return e?"<div>".concat(e.replace(/\s/g,"&nbsp;").replace(/<a&nbsp;data-selection/g,'<a style="color:#3c6ef0;" class="remark-anchor" target=\'__blank\' href'),"</div>"):"<div><br></div>"})).join("")},initRequestAddressTableData:function(){"uat"!==window.env.baseEnv&&"prod"!==window.env.baseEnv||(this.requestAddressTableData.push({environment:"线上环境",address:"https://api.jdl.com"}),this.requestAddressTableData.push({environment:"uat环境",address:"https://uat-api.jdl.com"})),"devtest"!==window.env.baseEnv&&"lEnv"!==window.env.baseEnv||this.requestAddressTableData.push({environment:"测试环境",address:"https://test-api.jdl.com"})},initPublicParamsTableData:function(){this.publicParamsTableData.push({name:"LOP-DN",type:"String",required:"1",remark:this.domainCode}),this.publicParamsTableData.push({name:"app_key",type:"String",required:"1",remark:"调用方应用的app_key"}),this.getSecurityConfiguration()},getSecurityConfiguration:function(){var e=this;return Object(i.a)(Object(r.a)().mark((function t(){var a,i,s,n,l;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.domainId,"hmac-auth",i=[{domainId:a,templateCode:"hmac-auth"}],t.next=5,o.a.getSecurityConfiguration(i).catch((function(t){var a=t.data.message;e.$message.error("".concat(a))}));case 5:(s=t.sent)&&(null!==(n=s.data.data)&&n.length>0&&(l=JSON.parse(n[0].templateConfig),e.addSecurityParams(l)));case 7:case"end":return t.stop()}}),t)})))()},addSecurityParams:function(e){this.publicParamsTableData.push({name:"sign",type:"String",required:"1",remark:"签名"});for(var t=0;t<e.auth.rules.length;t++)if(2===e.auth.rules[t].type){if("timestamp"===e.auth.rules[t].name){this.publicParamsTableData.push({name:"timestamp",type:"String",required:"1",remark:"调用时的系统时间（注意：一定要用GMT的时间，例如：Tue, 16 Jan 2018 08:56:59 GMT）"});continue}if("v"===e.auth.rules[t].name){this.publicParamsTableData.push({name:"v",type:"String",required:"1",remark:"API协议版本，可选值:2.0"});continue}}}},mounted:function(){this.initRequestAddressTableData(),this.initPublicParamsTableData(),this.inParamsTableData=this.inParamList,this.outParamsTableData=this.outParamList,this.errorCodeTableData=this.errorCodeList}}),l=n,p=(a("dd90"),a("2877")),c=Object(p.a)(l,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"my-wrap"},[t("div",{staticClass:"my-column"},[t("div",[e._m(0),t("el-table",{staticClass:"my-table mb2",staticStyle:{"margin-bottom":"25px"},attrs:{data:e.requestAddressTableData,"row-key":"id"}},[t("el-table-column",{attrs:{"show-tooltip-when-overflow":!0,label:"环境","min-width":"22%",prop:"environment"}}),t("el-table-column",{attrs:{"show-tooltip-when-overflow":!0,label:"域名","min-width":"39%",prop:"address"}}),t("el-table-column",{attrs:{"show-tooltip-when-overflow":!0,label:"调用地址","min-width":"39%",prop:"url"}},[[t("span",[e._v(e._s(e.url))])]],2)],1),t("h4",{staticClass:"document-sub-title"},[e._v("URL参数")]),t("el-table",{staticClass:"my-table mb2",staticStyle:{"margin-bottom":"25px"},attrs:{data:e.publicParamsTableData,"row-key":"id"}},[t("el-table-column",{attrs:{"show-tooltip-when-overflow":!0,label:"名称","min-width":"20%",prop:"name"}}),t("el-table-column",{attrs:{"show-tooltip-when-overflow":!0,label:"类型","min-width":"10%",prop:"type"}}),t("el-table-column",{attrs:{label:"是否必选","min-width":"10%",prop:"required"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s("1"===a.row.required?"是":""))]),t("span",[e._v(e._s("0"===a.row.required?"否":""))]),t("span",[e._v(e._s((a.row.required,"")))])]}}])}),t("el-table-column",{attrs:{"show-tooltip-when-overflow":!0,label:"描述","min-width":"60%",prop:"remark"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("p",{staticClass:"line-feed"},[e._v(e._s(a.row.remark))])]}}])})],1),t("h4",{staticClass:"document-sub-title"},[e._v("请求参数")]),t("el-table",{staticClass:"my-table mb2",staticStyle:{"margin-bottom":"25px"},attrs:{data:e.inParamsTableData,"tree-props":{children:"children"},"row-key":"id"}},[t("el-table-column",{attrs:{"show-tooltip-when-overflow":!0,label:"名称","min-width":"22%",prop:"name"}}),t("el-table-column",{attrs:{"show-tooltip-when-overflow":!0,label:"类型","min-width":"20%",prop:"type"}}),t("el-table-column",{attrs:{label:"是否必选","min-width":"15%",prop:"required"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s("1"===a.row.required?"是":""))]),t("span",[e._v(e._s("0"===a.row.required?"否":""))]),t("span",[e._v(e._s("2"===a.row.required?"条件":""))])]}}])}),t("el-table-column",{attrs:{"show-tooltip-when-overflow":!0,label:"示例值","min-width":"15%",prop:"exampleValue"}}),t("el-table-column",{attrs:{"show-tooltip-when-overflow":!0,label:"描述","min-width":"28%",prop:"remark"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"wb-doc-title",domProps:{innerHTML:e._s(e.formatTableColumnDescriptionInnerHtml(a.row.remark))}})]}}])})],1),t("h4",{staticClass:"document-sub-title"},[e._v("响应参数")]),t("el-table",{staticClass:"my-table mb2",staticStyle:{"margin-bottom":"25px"},attrs:{data:e.outParamsTableData,"tree-props":{children:"children"},"row-key":"id"}},[t("el-table-column",{attrs:{"show-tooltip-when-overflow":!0,label:"名称","min-width":"22%",prop:"name"}}),t("el-table-column",{attrs:{"show-tooltip-when-overflow":!0,label:"类型","min-width":"20%",prop:"type"}}),t("el-table-column",{attrs:{"show-tooltip-when-overflow":!0,label:"示例值","min-width":"15%",prop:"exampleValue"}}),t("el-table-column",{attrs:{"show-tooltip-when-overflow":!0,label:"描述","min-width":"28%",prop:"remark"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"wb-doc-title",domProps:{innerHTML:e._s(e.formatTableColumnDescriptionInnerHtml(a.row.remark))}})]}}])})],1),t("h4",{staticClass:"document-sub-title"},[e._v("错误码")]),t("el-table",{staticClass:"my-table mb2",staticStyle:{"margin-bottom":"25px"},attrs:{data:e.errorCodeTableData,"tree-props":{children:"children"},hideEmptyImg:"","row-key":"id"}},[t("el-table-column",{attrs:{label:"错误码","min-width":"20%",prop:"errorCode"}}),t("el-table-column",{attrs:{label:"错误信息",prop:"errorMsg"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("p",{staticClass:"line-feed"},[e._v(" "+e._s(a.row.errorMsg)+" ")])]}}])})],1),t("h4",{staticClass:"document-sub-title"},[e._v("API工具")]),t("el-row",[t("el-button",{attrs:{disabled:"",type:"primary"}},[e._v("API测试 ")]),t("el-alert",{staticStyle:{"margin-bottom":"20px","margin-top":"20px"},attrs:{closable:!1,title:"生产环境API测试不可用，请移步测试环境（测试环境地址：http://test-lcp.jdl.com）",type:"error"}})],1)],1)])])}),[function(){var e=this,t=e._self._c;return t("div",[t("h4",{staticClass:"document-sub-title",staticStyle:{float:"left"}},[e._v("请求地址")]),t("a",{staticClass:"link",staticStyle:{color:"#3c6ef0",float:"right"},attrs:{href:"http://lcp.jdl.com/#/docSoftwareSystem/17/2570"}},[e._v(" 更多请求地址 ")])])}],!1,null,"5c63ce1e",null),u=c.exports,d=a("7a3a"),m=a("6aca"),b=a("7562"),f=a("a78e"),h=a.n(f),y={components:{HttpDocument:u},data:function(){return{apiInfo:{url:"",name:"",domainId:"",domainCode:"",remark:""},inParamList:[],outParamList:[],errorCodeList:[],isShow:!1,applyApiDialogShow:!1,applyApiForm:{instanceId:"",tps:0,businessCase:"",selectApp:null},appList:[],rules:{url:[{required:!0,message:"请选择接口"}],name:[{required:!0,message:"请填入实现中文名"}],selectApp:[{required:!0,message:"请选择App"}],tps:[{required:!0,message:"请输入调用量"},{type:"number",message:"请输入调用量。10-1000000",min:10,max:1e6}],businessCase:[{required:!0,message:"请输入至少十个字的使用场景描述",min:10,max:200}]},applyLoading:"",disabled:!1,applySuccessDialog:!1,hasLogIn:m.a.loginState}},methods:{getHttpAPIDetail:function(){var e=this;return Object(i.a)(Object(r.a)().mark((function t(){var a,i,s,n;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.$route.query.id,i=[{id:a}],t.next=4,o.a.getHttpDocumentDetail(i).catch((function(t){var a=t.data.message;e.$message.error("".concat(a))}));case 4:(s=t.sent)&&(n=s.data,e.applyApiForm.instanceId=n.id,e.apiInfo.url=n.url,e.apiInfo.name=n.name,e.apiInfo.domainId=n.domainId,e.apiInfo.domainCode=n.domainCode,e.apiInfo.remark=n.remark,e.inParamList=n.inParamList,e.outParamList=n.outParamList,e.errorCodeList=n.errorCodeList,e.isShow=!0);case 6:case"end":return t.stop()}}),t)})))()},applyApi:function(){var e=this;return Object(i.a)(Object(r.a)().mark((function t(){var a;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.$refs.applyApiForm,e.hasLogIn){t.next=7;break}return t.next=5,m.a.intranetCheckLogin();case 5:t.next=14;break;case 7:if(-1!==Number(h.a.get("supplierId"))){t.next=12;break}return t.next=10,m.a.handleGetTeamListInfo();case 10:t.next=14;break;case 12:Object(s.a)("/app/findAppInfoListNoPage").then((function(t){e.appList=t.data,e.applyApiDialogShow=!0,e.applyApiForm.url=e.apiInfo.url,e.applyApiForm.name=e.apiInfo.name,e.applyApiForm.appId="",e.applyApiForm.tps="",e.applyApiForm.businessCase="",a&&a.resetFields()}));case 14:case"end":return t.stop()}}),t)})))()},submit:function(){var e=this;this.$refs.applyApiForm.validate((function(t){if(t){var a={instanceId:e.applyApiForm.instanceId,appKey:e.applyApiForm.selectApp.code,appName:e.applyApiForm.selectApp.name,tps:e.applyApiForm.tps,businessCase:e.applyApiForm.businessCase};return e.applyLoading=d.Loading.service({lock:!0,text:"正在提交任务，请稍等",spinner:"el-icon-loading"}),e.disabled=!0,b.a.post("/HttpApiService/submitApiApply",[a]).then((function(t){2e4===t.code?(e.applyApiDialogShow=!1,e.disabled=!1,e.applyLoading.close(),e.applySuccessDialog=!0):d.Message.error(t.message)})).catch((function(t){e.disabled=!1;try{e.applyLoading.close()}catch(t){}})),!1}return!1}))},gotoApiList:function(){window.location.href="".concat(window.location.origin,"/admin/#/appManager/appTabs/").concat(this.applyApiForm.selectApp.id,"?tabName=304")}},mounted:function(){this.getHttpAPIDetail()}},w=y,v=(a("6720"),Object(p.a)(w,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"my-wrap my-pd"},[t("el-breadcrumb",{staticClass:"my-breadcrumb mb2",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/apiStore"}}},[e._v("API仓库")]),t("el-breadcrumb-item",[e._v("API详情")])],1),t("div",{staticClass:"my-column2 mb2"},[t("el-row",[t("el-col",{attrs:{span:21}},[t("h3",[e._v(e._s(this.apiInfo.url)+"（"+e._s(this.apiInfo.name)+"）")])]),t("el-col",{attrs:{span:3}},[t("span",{staticClass:"fr",staticStyle:{"margin-top":"12px"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.applyApi}},[e._v("申请使用")])],1)])],1),t("p",{staticClass:"remark-content"},[e._v(e._s(this.apiInfo.remark))])],1),e.isShow?t("HttpDocument",{attrs:{url:e.apiInfo.url,domainId:e.apiInfo.domainId,domainCode:e.apiInfo.domainCode,inParamList:e.inParamList,outParamList:e.outParamList,errorCodeList:e.errorCodeList}}):e._e(),t("el-dialog",{attrs:{visible:e.applyApiDialogShow,title:"API申请",width:"500px"},on:{close:function(t){e.applyApiDialogShow=!1}}},[t("el-form",{ref:"applyApiForm",attrs:{model:e.applyApiForm,rules:e.rules,"label-width":"120px","hide-required-asterisk":!1}},[t("el-form-item",{attrs:{label:"API名称",prop:"url"}},[t("el-input",{attrs:{disabled:"",placeholder:"请选择实现"},model:{value:e.apiInfo.url,callback:function(t){e.$set(e.apiInfo,"url",t)},expression:"apiInfo.url"}})],1),t("el-form-item",{attrs:{label:"中文名称",prop:"name"}},[t("el-input",{attrs:{disabled:"",placeholder:"中文名称"},model:{value:e.apiInfo.name,callback:function(t){e.$set(e.apiInfo,"name",t)},expression:"apiInfo.name"}})],1),t("el-form-item",{attrs:{label:"应用",prop:"selectApp"}},[t("el-select",{attrs:{placeholder:"请选择应用","value-key":"id"},model:{value:e.applyApiForm.selectApp,callback:function(t){e.$set(e.applyApiForm,"selectApp",t)},expression:"applyApiForm.selectApp"}},e._l(e.appList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e}})})),1)],1),t("el-form-item",{attrs:{label:"申请调用量",prop:"tps"}},[t("el-input",{attrs:{placeholder:"申请调用量"},model:{value:e.applyApiForm.tps,callback:function(t){e.$set(e.applyApiForm,"tps",e._n(t))},expression:"applyApiForm.tps"}},[t("template",{slot:"append"},[e._v("TPS")])],2)],1),t("el-form-item",{attrs:{label:"使用场景",prop:"businessCase"}},[t("el-input",{attrs:{rows:3,maxlength:"200",placeholder:"请输入使用场景",resize:"none","show-word-limit":"",type:"textarea"},model:{value:e.applyApiForm.businessCase,callback:function(t){e.$set(e.applyApiForm,"businessCase",t)},expression:"applyApiForm.businessCase"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.applyApiDialogShow=!1}}},[e._v("取 消")]),t("el-button",{attrs:{disabled:e.disabled,type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{visible:e.applySuccessDialog,title:"提示",width:"500px"},on:{close:function(t){e.applySuccessDialog=!1}}},[t("div",{staticClass:"text"},[e._v("申请成功，请等候审批结果通知")]),t("p",[e._v(" 审批通过后，请到 "),t("a",{staticClass:"link",on:{click:function(t){return e.gotoApiList()}}},[e._v("控制台-应用管理-调用的API列表")]),e._v(" 中查看申请的API ")]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.applySuccessDialog=!1}}},[e._v("关闭")])],1)])],1)}),[],!1,null,"58deaac8",null));t.default=v.exports},6720:function(e,t,a){"use strict";a("4e92")},7562:function(e,t,a){"use strict";var r=a("c7eb"),i=a("1da1"),s=(a("d3b7"),a("e9c4"),a("bc3a")),o=a.n(s),n=a("2c7f"),l=a("6aca"),p=a("7a3a"),c=a("48ea"),u=a("a78e"),d=a.n(u),m=!1,b=o.a.create({baseURL:window.env.gatewayApiDecoupling,withCredentials:!0,timeout:1e4,headers:{"LOP-DN":window.env.gatewayApiDecouplingLop,"Account-Type":Object(c.a)()?"erp":"passport"}});function f(){return h.apply(this,arguments)}function h(){return h=Object(i.a)(Object(r.a)().mark((function e(){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.SET_LOGIN_STATE(!1);case 2:sessionStorage.setItem("store",JSON.stringify(n.a.state)),p.MessageBox.confirm("您的登录状态已失效，是否重新登录？","提示",{confirmButtonText:"登录",cancelButtonText:"不登录",type:"warning"}).then((function(){m=!1,l.a.handleLogout(),Object(c.a)()?l.a.intranetCheckLogin():l.a.extranetCheckLogin()})).catch((function(){m=!1}));case 4:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}b.interceptors.request.use((function(e){return e.headers.groupCode=d.a.get("groupCode")||"",e}),(function(e){return Promise.reject(e)})),b.interceptors.response.use((function(e){var t=e.status;if(e.data.error_response)return p.Message.error("服务异常"),Promise.reject(e);if(401===t||520===t)return m||(m=!0,f()),Promise.reject(e);if(e.data.response){var a=e.data.response,r=a.code,i=a.message;return 2e4===r?e.data.response:(i&&p.Message.error(i),Promise.reject(e.data.response))}return Promise.reject(e)}),(function(e){var t=e.response.status;return e.response.data.error_response&&p.Message.error("服务异常"),401!==t&&520!==t||m||(m=!0,f()),Promise.reject(e.response)})),t.a=b},bd97:function(e,t,a){"use strict";a("e9c4");var r=a("7562"),i={queryApiReleaseByCondition:function(e){var t={url:"/ApiDepotService/queryApiReleaseByCondition",method:"post",data:JSON.stringify(e)};return Object(r.a)(t)},queryApiCategory:function(e){var t={url:"/ApiManagerService/queryApiCategory",method:"post",data:JSON.stringify(e)};return Object(r.a)(t)},getHttpApiList:function(e){var t={url:"/HttpApiService/queryApiReleaseList",method:"post",data:e};return Object(r.a)(t)},getDomainCodeList:function(e){var t={url:"/CloudDomainService/query",method:"post",data:e};return Object(r.a)(t)},getHttpDocumentDetail:function(e){var t={url:"/HttpApiService/findApiDocRelease",method:"post",data:e};return Object(r.a)(t)},getSecurityConfiguration:function(e){var t={url:"/CloudPluginManagerService/queryPublishedCloudPlugin",method:"post",data:e};return Object(r.a)(t)}};t.a=i},dd90:function(e,t,a){"use strict";a("e163e")},e163e:function(e,t,a){}}]);